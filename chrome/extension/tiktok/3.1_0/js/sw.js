(()=>{var t={815:t=>{t.exports={t:function(t,e){e&&!Array.isArray(e)&&(e=[e]);for(var n,r=[],o={"{":0,"[":0},i={"}":"{","]":"["},u=/[{}\]\[":0-9.,-]/,c=/[\r\n\s\t]/,s="",_=0;n=t[_];_++)if('"'!==n)u.test(n)?(s+=n,"{"===n||"["===n?(o["{"]||o["["]||(s=n),o[n]++):"}"!==n&&"]"!==n||(o[i[n]]--,o["{"]||o["["]||r.push(s))):"t"===n&&"true"===t.substr(_,4)?(s+="true",_+=3):"f"===n&&"false"===t.substr(_,5)?(s+="false",_+=4):"n"===n&&"null"===t.substr(_,4)?(s+="null",_+=3):c.test(n)||(o["{"]=0,o["["]=0,s="");else{for(var a=_;-1!==a&&(a===_||"\\"===t[a-1]);)a=t.indexOf('"',a+1);-1===a&&(a=t.length-1),s+=t.substr(_,a-_+1),_=a}var f,l=[];for(_=0;f=r[_];_++)if("{}"!==f&&"[]"!==f)try{e?e.every((function(t){return t.test(f)}))&&l.push(JSON.parse(f)):l.push(JSON.parse(f))}catch(t){}return l},i:function(){var t,e,n="",r=""+parseFloat(navigator.userAgent.match(/\d+\.\d+/)[0]),o=navigator.userAgent;return-1!==o.indexOf("Edge")||-1!==o.indexOf("Edg")?(n="Microsoft Edge",-1!==o.indexOf("Edge")?(t=o.indexOf("Edge"),r=o.substring(t+5)):(t=o.indexOf("Edg"),r=o.substring(t+4))):-1!==(t=o.indexOf("MSIE"))?(n="Microsoft Internet Explorer",r=o.substring(t+5)):-1!==o.indexOf("Chrome")?-1!==(t=o.indexOf("Chrome"))&&(n="Chrome",r=o.substring(t+7)):-1!==o.indexOf("Safari")?-1!==(t=o.indexOf("Safari"))&&(n="Safari",r=o.substring(t+7),-1!==(t=o.indexOf("Version"))&&(r=o.substring(t+8))):-1!==(t=o.indexOf("Firefox"))&&(n="Firefox",r=o.substring(t+8)),-1!==(e=r.indexOf(";"))&&(r=r.substring(0,e)),-1!==(e=r.indexOf(" "))&&(r=r.substring(0,e)),-1!==(e=r.indexOf(")"))&&(r=r.substring(0,e)),{browser:n,browser_version:r,full_browser_version:navigator.userAgent.match(/\d+\..+/)[0]}},u:()=>Promise.resolve().then((function(){return navigator.getBattery?navigator.getBattery():1})),_:function(t,e,n){t.sort((function(t,r){var o=parseInt(t[e]),i=parseInt(r[e]);return n?o<i?1:o>i?-1:0:o>i?1:o<i?-1:0}))}}},303:(t,e,n)=>{n(178);t.exports={l(t){chrome.tabs.get(t.tabId).then((function(e){if(chrome.runtime.lastError||!e||!e.url)return;let n=e.url.match(/tiktok\.com\/@([^/?#]+)/);n=n&&n[1];let r=new URLSearchParams(t.url).get("secUid");n&&r&&chrome.storage.local.get("secUids").then((t=>{const e=t.secUids||{};e[n]=r,chrome.storage.local.set({secUids:e})}))}))},$:t=>chrome.storage.local.get("secUids").then((e=>({secUid:(e.secUids||{})[t]})))}},172:t=>{t.exports=function(){let t=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,e=/[\/\?<>\\:\*\|"~]/g,n=/[\x00-\x1f\x80-\x9f]/g,r=/^\.+/,o=/^(.+)\.([a-z0-9]{1,4})$/i,i="nbsp,iexcl,cent,pound,curren,yen,brvbar,sect,uml,copy,ordf,laquo,not,shy,reg,macr,deg,plusmn,sup2,sup3,acute,micro,para,middot,cedil,sup1,ordm,raquo,frac14,frac12,frac34,iquest,Agrave,Aacute,Acirc,Atilde,Auml,Aring,AElig,Ccedil,Egrave,Eacute,Ecirc,Euml,Igrave,Iacute,Icirc,Iuml,ETH,Ntilde,Ograve,Oacute,Ocirc,Otilde,Ouml,times,Oslash,Ugrave,Uacute,Ucirc,Uuml,Yacute,THORN,szlig,agrave,aacute,acirc,atilde,auml,aring,aelig,ccedil,egrave,eacute,ecirc,euml,igrave,iacute,icirc,iuml,eth,ntilde,ograve,oacute,ocirc,otilde,ouml,divide,oslash,ugrave,uacute,ucirc,uuml,yacute,thorn,yuml".split(","),u=[["amp","quot","lt","gt"],[38,34,60,62]],c=/&([^;]{2,6});/g,s=/\r?\n/g,_=/[\*\?"]/g,a=/</g,f=/>/g,l=/[\s\t\uFEFF\xA0]+/g,d=/(\.|!|\?|_|,|\-|:|\+){2,}/g,$=/[\.,:;\/\-_\+=']$/g;return{m:function(t,e,n){if(!t)return null;n=n?`_${n}`:"";let r,o="video_keeper_"+(e=e?`${e}_`:"");try{let e=new URL(t);r=null==e.searchParams.get("br")?o+e.pathname.split("/")[1]+"_"+e.pathname.split("/")[3]+n+".mp4":o+e.searchParams.get("br")+"_"+e.searchParams.get("bt")+n+".mp4"}catch(t){r=o+Date.now()+".mp4"}return r},h:function(m){if(!m)return"";m=function(t){try{return JSON.parse(JSON.stringify(t).replace(/\\(\\u[0-9a-f]{4})/g,"$1"))}catch(e){return t}}(m);try{m=decodeURIComponent(m)}catch(t){m=unescape(m)}if((m=(m=function(e){return e.replace(t,"")}(m=(m=m.replace(c,(function(t,e){var n=null;if("#"===e[0])return n=parseInt(e.substr(1)),isNaN(n)?"":String.fromCharCode(n);var r=u[0].indexOf(e);return-1!==r?(n=u[1][r],String.fromCharCode(n)):-1!==(r=i.indexOf(e))?(n=r+160,String.fromCharCode(n)):""}))).replace(s," "))).replace(_,"").replace(a,"(").replace(f,")").replace(l," ").replace(d,"$1").replace(e,"_").replace(n,"").replace(r,"").replace($,"")).length<=this.maxLength)return m;var h=function(t){return t.match(o)}(m);return h&&3===h.length?(h[1]=h[1].substr(0,this.maxLength),h[1]+"."+h[2]):m}}}()},178:t=>{t.exports={g:"260103",p:3,v:1988,k:"api-h2.tiktokv.com",S:"26.1.3",T:"tiktok.com",D:["rate","one_by_one_warning_disabled","selectors","secUids","rate_count"],O:15,A:"rr",U:4,N:9,I:5,L:2,P:"mt_",B:1,R:6,M:7,C:2,F:"https://check.qippin.com/config.json",j:"config_mtime",H:17,J:1}}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r](i,i.exports,n),i.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t=n(172),e=n.n(t),r=n(178),o=n.n(r);function i(t,e=16){let n="",r=t.length;for(let o=0;o<e;o++)n+=t.charAt(Math.floor(Math.random()*r));return n}const u={q(t){if(t.filename_by_title=t.filename_by_title?t.filename_by_title:e().m(t.title,t.author,t.title),t.filename_by_url=t.filename_by_url?t.filename_by_url:e().m(t.video_url,t.author),!t.str_id){let e=null;t.video_id&&"string"==typeof t.video_id?e=t.video_id:t.video_id&&t.video_id[1]&&(e=t.video_id[1]),t.str_id=e}return t.fetch_opt={},t.video_url&&t.video_url.match(/webapp-prime\.(\w+\.)?tiktok\./)&&(t.fetch_opt.credentials="include",t.video_url.includes("TT-vCache")||(t.video_url+="&__vid=TT-vCache-"+t.str_id)),t},W(t,e,n,r="aweme/detail"){let u=o().k,c=Math.round(Date.now()/1e3),s={aweme_id:t,version_name:e,version_code:n,build_number:e,manifest_version_code:n,update_version_code:n,openudid:i("0123456789abcdef",16),uuid:i("0123456789",16),_rticket:1e3*c,ts:c,device_brand:"Google",device_type:"Pixel 4",device_platform:"android",resolution:"1080*1920",dpi:420,os_version:"10",os_api:"29",carrier_region:"US",sys_region:"US",region:"US",app_name:"trill",app_language:"en",language:"en",timezone_name:"America/New_York",timezone_offset:"-14400",channel:"googleplay",ac:"wifi",mcc_mnc:"310260",is_my_cn:0,aid:1180,ssmix:"a",as:"a1qwert123",cp:"cbfhckdckkde1"};return`https://${u}/aweme/v1/${r}/`+Object.keys(s).map(((t,e)=>`${e>0?"&":"?"}${t}=${s[t]}`)).join("")},K:t=>new Promise(((e,n)=>{fetch(t).then((t=>t.json())).then((t=>e(t))).catch((t=>n(t)))}))};var c=n(815),s=n.n(c);const _={V:{},G:t=>new Promise((function(e,n){chrome.downloads.download(t,(function(t){if(chrome.runtime.lastError)return n("runtime.lastError");t?e(t):n("No downloadId")}))})),Y:function(t,e){let n=this;t=u.q(t),new Promise((function(e,r){if(!t.filename_by_title)throw"No filename by title";n.G({url:t.video_url,filename:t.filename_by_title}).then(e).catch(r)})).catch((function(e){if(!t.filename_by_url)throw"No filename by url";return n.G({url:t.video_url,filename:t.filename_by_url})})).catch((function(e){return n.G({url:t.video_url})})).then((function(r){n.V[r]={time:Date.now(),opts:t,callback:e}})).catch((function(){e({status:"error",opts:t})}))},X(t,e){if(t.video_url&&0===t.video_url.indexOf("https"))return e(t);let n=new AbortController,r=n.signal,o=setTimeout((()=>n.abort()),3e3);fetch(t.post_url,{signal:r}).then((t=>(clearTimeout(o),t.text()))).then((n=>{let r=s().t(n),o=t.post_url.match(/\/video\/(\d+)/);o=o&&o[1];let i,u=r.find((function(t){return t.ItemModule}));return o&&(i=u&&u.ItemModule[o]),i||(i=u&&Object.values(u.ItemModule)[0]),i?(t.video_url=i.video&&(i.video.playAddr||i.video.downloadAddr),t.title=i.desc):(r=r.filter((t=>t.Bitrate)),s()._(r,"Bitrate",!0),i=r[0],i&&(t.video_url=i.PlayAddr&&i.PlayAddr.UrlList&&i.PlayAddr.UrlList[0])),e(t)})).catch((n=>{e(t)}))},Z:function(t,e){let n=this;if(!t||!t.video_url&&!t.post_url)return e({status:"error"});n.X(t,(function(t){if(!t||!t.video_url)return e({status:"error"});n.Y(t,e)}))},tt(){let t=this;chrome.downloads.onChanged.addListener((function(e){if(t.V[e.id]){let n;if(e.error&&"USER_CANCELED"===e.error.current&&Date.now()>t.V[e.id].time+300)n="cancelled";else if(e.error)n="error";else{if(!e.state||"complete"!==e.state.current)return;n="success"}t.V[e.id].callback({status:n,opts:t.V[e.id].opts}),delete t.V[e.id]}}))}},a={et:!1,nt:[],rt:null,ot:null,it:0,ut:0,ct:function(t){return t(this.et)},tt:function(t){let e=this;e.et||(e.et=!0,e.rt=t,e.ot=t.sender.tab.id,this._t(e.ot,"bulkProcessStarted"),e.rt.onMessage.addListener((function(t){"ping"===t?e.rt.postMessage("pong"):"start"===t.action?e.ft(t.downloadList):"stop"===t.action&&e.lt()})),e.rt.onDisconnect.addListener((function(){e.lt()})))},ft(t){let e=this;e.nt=t,e.it=t.length,e.dt({$t:function(){e.et&&(e.ut++,e.rt.postMessage({type:"step",count:e.ut}))},ht:function(){e.et&&(e.rt.postMessage({type:"finish"}),e.lt())}})},lt:function(){this._t(this.ot,"bulkProcessFinished"),this.et=!1,this.nt=[],this.rt=null,this.ot=null,this.it=0,this.ut=0},dt(t){let e=this;if(!e.nt.length)return t.ht();let n=e.nt.shift();n=u.q(n),chrome.tabs.sendMessage(e.ot,{action:"downloadByFetch",data:n},(function(n){n&&"success"===n.status&&t.$t(),e.dt(t)}))},_t:function(t,e){chrome.tabs.query({url:"https://*.tiktok.com/*"},(function(n){n.forEach((function(n){t!==n.id&&chrome.tabs.sendMessage(n.id,{action:e},(function(){if(chrome.runtime.lastError)return!1}))}))}))}};var f=n(303),l=n.n(f);let d=[];const $=function(t){return d[t]},m={gt(){d=[]},vt:()=>$(1),yt:$,bt:()=>$(4),wt:()=>$(5),kt(t){d=t},St:()=>$(6),Et:()=>$(0)};function h(){return g}const g=self;function p(){return Math.random()}function v(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(p()*(e-t+1))+t}function y(t){return t.location.href}function b(t){return p().toString().replace(/[0.]/g,"").slice(0,t)}const w={Tt:function(t){return t.toLowerCase().replace(new RegExp(`^${m.yt(8)}`),"")},Dt:()=>p(),Ot:function(t,e){const n=m.yt(9),r=this.At(t);if(t===r){const r=t.split(n);if(e.split(n).includes(r.shift()))return!0}else{if(e!==this.At(e)){const t=r.split(n).shift();return t.length>3&&e.split(n).includes(t)}{const r=e.split(n);if(t.split(n).includes(r.shift()))return!0}}return!1},xt:function(){return Math.floor(this.Dt())},Ut:function(t,e){return e.includes(t)||e.includes(this.At(t))},Nt:function(t,e){return e.forEach((function(e){t=t.replace(new RegExp(e[0],"g"),e[1])})),t},It:function(){return"="},Lt:function(t,e){return!(!t||!e)&&(t.includes(e)||e.includes(t)||e.includes(this.At(t)))},Pt:t=>y(t),At:function(t){const e=m.yt(9),n=t.split(e);return 3===n.length&&n.shift()&&(t=n.join(e)),t},Bt:()=>"\\d",Rt:function(t){return y(h()).replace(/[^\w]/g,"").includes(t.replace(/[^\w]/g,"").substring(0,15))},Mt(t,e){e=e?1e3*e:0,setTimeout(t,e)},Ct:function(t){return this.Tt(new URL(t).hostname)},Ft:function(t){return btoa(t)},jt:function(t){return encodeURIComponent(t)},Ht:()=>function(t,e,n){if(!n.length)return;let r,o,i=h();do{r=[].find.call(n,(function(t){return"string"==typeof t&&i[t]})),i=i[r],o=i||o}while(i);o&&(n[e]=o)},Jt:t=>Date.now()-t>1e3,qt:function(t){return atob(t)},Wt(t){return t.toString().replace(new RegExp(`[${this.Bt()}]`,"g"),"")},Kt:function(t){return new RegExp(`^${m.yt(7)}`).test(t)?this.Ct(t):null},zt(t,e,n){const r=b(e),o=this.Wt(t);let i,u=o,c=o;return[r,t*r,b(e)].forEach((t=>{u=u.concat(t)})),u.split(o).forEach((function(t){i=v(3,6);for(;e=.65,p()<e;)c=c.concat(String.fromCharCode(v(65,90)).toLowerCase()),n&&i&&c.length>=i&&!c.slice(-i).includes(n)&&(c=c.concat(n));var e;c=c.concat(t)})),c},Vt:function(t){const e=t.length,n=t.substring(e);return t.split(n).reverse().join(n)},Gt:function(){return"_"}},k=w.Bt(),S=function(t,e){let n,r;return r=o().L,n=t.toString().substring(3,10),w.zt(n,r)},E=function(t){const e=w.Ft(t),n=w.xt(),r=w.It(),o=w.Gt,i=k,u=w.Vt(e);return w.Nt(u,[[r,o],[i,t=>`${n}${t}`]])},T=function(t){return w.qt(w.Vt(w.Nt(t,[[`0${k}`,t=>t[1]],[w.Gt(),w.It]])))};function D(t,e,n){let r=null;try{let o="";for(let n of e){if(void 0===t[n])return null;o+=t[n]}if(!o.length)return null;r=n?JSON.parse(function(t,e){return t.replace(new RegExp(`${e}$`),"")}(T(o),n)):JSON.parse(T(o))}catch(t){}return r}function O(t,e="local"){return chrome.storage[e].set(t)}const A={Yt:function(t){const e=this;chrome.storage.local.get((function(n){Object.keys(n).map((function(n){t.includes(n)||e.Xt(n)}))}))},Xt:function(t){return chrome.storage.local.remove(t)},kt:function(){let t={};return 1===arguments.length?t=arguments[0]:2===arguments.length&&(t[arguments[0]]=arguments[1]),O(t)},Zt:function(){let t={};return 1===arguments.length?t=arguments[0]:2===arguments.length&&(t[arguments[0]]=arguments[1]),O(t,"sync")},Qt:function(t,e,n){const r={};let o;o=E(n?function(t,e){return t.concat(e)}(JSON.stringify(e),n):JSON.stringify(e));const i=Math.round(o.length/t.length);let u=0;try{for(let e in t)t.hasOwnProperty(e)&&(+e<t.length-1?(r[t[e]]=o.slice(u,i),u+=i):r[t[e]]=o.slice(u),e++)}catch(t){}return O(r)},te:function(t){return t=t.toString(),chrome.storage.local.get(t).then((function(e){return e[t]}))},ee:function(t){return chrome.storage.sync.remove(t)},ne:function(t,e){return Array.isArray(t)||(t=[t]),t=t.map((t=>t.toString())),chrome.storage.local.get(t).then((function(n){return Object.keys(n).length!==t.length?null:D(n,t,e)}))},re:function(t){const e=t[0],n=t[1];return chrome.storage.local.get().then((function(t){const r=[];for(let o=e;o<=n&&t[o];o++){if(!t[o])return null;r.push(t[o])}return r.length?D(r,Object.keys(r)):null}))},oe:function(t){return t=t.toString(),chrome.storage.sync.get(t).then((function(e){return e[t]}))},ie:D};let x,U={};function N(){const t={},e=Date.now();for(let n in U)U[n]+x>e&&(t[n]=U[n]);U=t,A.Qt([o().N,o().B],U)}const I={ue(t){U[t]=Date.now(),w.Mt(N)},ce(t){x=t,A.ne([o().N,o().B]).then((function(t){U=t||{},w.Mt(N)}))},se:t=>U.hasOwnProperty(t),_e(t){}};function L(t,e){let n={};return void 0!==t&&(n.currentWindow=Boolean(t)),void 0!==e&&(n.active=Boolean(e)),chrome.tabs.query(n)}const P={ae:function(t){return chrome.tabs.get(t)},fe:function(t){return chrome.tabs.query({url:t}).then((function(t){const e=[];return t.forEach((function(t){e.push(t.id)})),e}))},le:function(){return L(!0,!0).then((function(t){return t.length}))},de:L};const B=function(t){return A.oe("uid").then((e=>(e||(e=function(t){let e=t.toString().substring(1,6);return w.zt(e,o().L,"-")}(t||Date.now()),A.Zt("uid",e)),e)))},R={$e:function(t,e){return this.me(t,e).then((t=>{const e=t.headers.get("Content-Type");if(e&&e.includes("json"))return t.json()}))},me:function(t,e){return fetch(t,{credentials:"include",body:e,method:"POST"})}};let M,C;function F(t,e,n,r){return n||A.kt(o().j,e),function(t,e,n,r){let i;return i={},Promise.all([B(e),t&&A.te("st"),A.te(o().P),W.he()]).then((function(r){const[u,c,s,_]=r;return C=void 0!==s,!n&&C&&(i.cfg=C),i.uid=u,!n&&t&&(i[o().A]=S(e,!1)),!n&&t&&_&&(i.st=c),!n&&s&&(i[o().P]=s),i.ext_vs=chrome.runtime.getManifest().version,i})).then((t=>JSON.stringify(t)))}(t,e,n).then((t=>R.$e(o().F,t))).then((function(t){!n&&async function(){C&&await W.ge();M&&await W.pe()}();const e=t||{};return A.kt(e)}))}function j(t){return t&&A.te("scl").then((t=>{if(!t||t.length<10)return null;const e={};return e.scl=t,e.ext_vs=chrome.runtime.getManifest().version,JSON.stringify(e)})).then((t=>{if(t)return W.ve(),R.me(o().F,t)}))}const H={ye(t,e){let n,r;const i=Date.now();let u;return P.le().then((function(t){return M=t,Promise.all([A.te("tt"),A.te(o().j),B(i)])})).then((function(e){return[n,r,u]=e,n=n||4,t||function(t,e,n,r){return!t||t+36e5*e<n}(r,n,i)?F(M,i,t):j(M)})).catch((function(t){}))},be:()=>P.le().then(j).catch((function(){}))};function J(){return A.ne("st",o().T).then((function(t){return t||[]}))}function q(t){return A.Qt(["st"],t,o().T)}const W={we:function(t){return J().then((function(e){return t.forEach((function(t){e[t]=(e[t]||0)+1})),q(e)}))},ke:function(t){return J().then((function(e){return e[t]=0,q(e)}))},pe:function(){return this.we([0])},he:function(){return J().then((function(t){return t[0]>1}))},ve:function(t){return A.ne("scl").then((function(e){if(e=e||[],t){e.push(t);const n=Math.ceil(100*w.Dt());w.Mt(H.be,n)}else e=[];return A.Qt(["scl"],e)}))},Se:function(){this.ke(3)},Ee:function(){this.ke(1)},ge:function(){return this.we([1,2,3])},Te:function(){this.ke(2)}};let K,z,V,G,Y,X;function Z(t,e){if(!e)return!1;let n=0;for(;e[n];){if(new RegExp(e[n]).test(t))return!0;n++}}const Q={De:t=>Z(t,G),gt(){[G,V,K,z]=[]},Oe(t){[G,V,K,Y,X]=t,X=X&&new RegExp(X)},Ae(t){if(!X||!this.De(t))return!1;let e=t.match(X);return e=e&&e[1]&&e[1].toLowerCase(),e&&K&&K.find((function(t){return new RegExp(t).test(e)}))?(W.Se(),!0):void 0},xe:t=>Z(t,V),Ue(t,e){if(!Y)return t;if(!Y[e])return t;for(let n of Y[e])for(let e of n.match)if(e=new RegExp(e),e.test(t)){if(n.replace)for(let e of n.replace)e=new RegExp(e),t=t.replace(e,"");return t}return null},Ne(t){z=t},Ie(t){if(z&&w.Ut(t,z))return W.Te(),!0}};let tt={};function et(t){return t.split(w.Gt())[0]}function nt(){const t=Date.now();for(let e in tt){const n=tt[e];for(let e in n)n[e]+rt<t&&delete n[e];Object.values(n).length||delete tt[e]}A.Qt([o().H,o().O],tt)}const rt=1728e6,ot={Le(t,e){let n=null;if(tt.hasOwnProperty(t)){const r=Object.keys(tt[t]);n=e.find((function(t){return!r.includes(et(t))}))}return n||e[0]},Pe(t,e){tt[t]||(tt[t]={}),tt[t][et(e)]=Date.now(),w.Mt(nt)},Be(){A.ne([o().H,o().O]).then((function(t){tt=t||{},w.Mt(nt)}))}};let it,ut;const ct={Re(t){if(!it||"object"!=typeof it)return null;let e=null,n=it[t],r=null;if(n||(r=w.At(t),n=it[r]),!n||!n.length)return null;const o=ot.Le(t,n),i=ut[o];e={};let u={};u[1]=r||t;const c=i[1];let s=i[2];if(!s&&c){if(s=c[t]||r&&c[r],!s)return null;u[2]=s}return Object.assign(e,i,u),e},Me(t){[it,ut]=t},gt(){it=null,ut=null}},st={Ce(t,e){if(!e||!t)return null;if(!e[2]||!e[5])return null;let n=e[2].replace(e[5],w.jt(t));return e[3]&&(n=e[3].concat(w.jt(w.Ft(n)))),n},Fe(t,e,n,r){if(Q.xe(t))return!1;let o=ct.Re(e);if(!o)return!1;let i=o[1],u=w.Lt(i,r),c=Q.De(n);if(!c&&!u&&!o[8])return!1;if(c&&!o[4])return!1;if(I.se(i))return!1;if(u&&!o[6])return!1;let s=Q.Ue(t,i);if(!s)return!1;const _=this.Ce(s,o);return o&&(o[10]=_),o}},_t={je(){const t=this;return P.de().then((function(e){return!e.find((function(e){return t.He(e[m.Et()])}))}))},He(t){if(w.Rt(t))return W.Ee(),!0}},at={},ft={Je(t,e){w.Kt(e)?at[t]=e:this.qe(t)},qe(t){delete at[t]},We(){const t=this;return P.de().then((function(e){e.forEach((function(e){t.Je(e.id,e[m.Et()])}))}))},Ke:t=>at[t]};let lt;const dt={};function $t(t){if(!vt[t])return;const e={},n=!vt[t][7];e[vt[t][1]]=[+n,vt[t][7]||vt[t][3],w.Kt(vt[t][0]),vt[t][2]],delete vt[t],W.ve(e)}let mt,ht,gt;function pt(){gt=!1,ct.gt();let t={};return t[o().P]=gt,A.kt(t),gt}const vt={};let yt;const bt={ze(){yt&&yt[m.St()]&&yt[m.St()](this.Ve)},Ge:(t,e)=>setTimeout((function(){P.ae(t).then((function(e){if(!chrome.runtime.lastError&&e||delete vt[t],!vt[t])return!1;const n=w.Kt(e[m.Et()]),r=w.Kt(vt[t][0]);if(!vt[t][4]||w.Lt(n,r)||w.Ot(n,r)||w.Lt(n,vt[t][2]))ft.Je(t,e[m.Et()]);else{const n={};vt[t][7]=e[m.Et()],n[m.Et()]=vt[t][0],lt[m.wt()](t,n)}$t(t)})).catch((function(){}))}),e),Ye(t){ht=t,gt=!0},Ve(t,e,n){const r=n[m.Et()],o=e[m.vt()];if(!r||!(m.yt(3)===o||m.yt(2)===o&&e[m.Et()]))return!1;if(bt.Xe(t,r,o))return!1;if(_t.He(r))return pt();let i=w.Kt(r);if(!i)return ft.qe(t),!1;if(Q.Ie(i)||Q.Ae(r))return pt();if(!gt)return!1;if(o!==m.yt(2)||!e[m.Et()])return!1;let u=ft.Ke(t);if(ft.Je(t,r),!u)return!1;if(dt[t])return!1;let c=w.Kt(u);const s=st.Fe(r,i,u,c);s&&bt.Ze(t,r,c,s)},Qe(t){yt=t.shift(),mt=t.shift(),lt=t.shift(),yt[m.bt()](this.Ve)},Ze(t,e,n,r){const o=r[10],i=r[1],u=r[0];if(!(o&&t&&i&&e))return!1;if(vt[t]||dt[t])return!1;const c={};c[m.Et()]=o,vt[t]=[e,u,n,o,r[9],Date.now()],dt[t]=!0,lt[m.wt()](t,c),I.ue(i),setTimeout((function(){delete dt[t]}),6e4),setTimeout((function(){$t(t)}),ht)},Xe(t,e,n){if(!vt[t])return!1;vt[t][6]&&clearTimeout(vt[t][6]);const r=w.Kt(e),o=w.Kt(vt[t][0]);if(r)w.Lt(o,r)||w.Ot(o,r)?($t(t),ft.Je(t,e)):!vt[t][4]||n!==m.yt(3)||w.Lt(vt[t][2],r)||w.Ot(vt[t][2],r)||(vt[t][6]=this.Ge(t,ht/2));else{vt[t][7]=e,$t(t);let n={};n[m.Et()]=vt[t][0],lt[m.wt()](t,n);const r=w.Kt(vt[t][0]),o=vt[t][1];ot.Pe(r,o)}return!0}},wt=bt,kt=["https://*.tiktok.com/*"];let St=function(){};const Et={tt:function(t,e,n){return St=this,function(t,e,n){setTimeout((function(){P.fe(kt).then((function(e){e&&e.forEach((function(e){const n=parseInt(e);t(n,(function(t){chrome.tabs.sendMessage(n,{action:"rcp",value:t},(function(){chrome.runtime.lastError}))}))}))}))}),2e3);const r=function(t){P.fe(kt).then((function(e){e&&e.includes(t.tabId.toString())&&chrome.tabs.sendMessage(t.tabId,{action:"rcp",value:t[n[0]]},(function(){chrome.runtime.lastError}))}))},o=function(e,r,o){if("test"===e)return t(r.tab.id,(function(t){o(n[2].concat([t]))})),!0;"found_new"===e&&(St(),i())},i=function(){chrome.runtime.onMessage.removeListener(o),e[n[3]](r)};return e[n[1]](r),chrome.runtime.onMessage.addListener(o),Promise.resolve(i)}(t,e,n)}};let Tt,Dt,Ot;function At(t,e,n){const r=function(){return new Promise((function(o){const i={};i[e]=[n],t(i,(function(t){t.length?(xt(),o(!1)):o(r)}))}))};return r}function xt(){clearInterval(Dt),A.Yt((o().D||[]).concat(o().j)),wt.ze(),Q.gt(),ct.gt(),Tt&&Tt(),m.gt()}const Ut=function(){return A.re([2,6]).then((function(t){if(!t)return!1;let e;return[e,Ot]=t,e.map(w.Ht()),Ot.map(w.Ht()),e})).then((function(t){return t&&At.apply(null,t)})).then((function(t){return t&&t().then((e=>e&&function(t){return Dt=setInterval((function(){t().catch((function(){}))}),3e3),!0}(t)))})).then((t=>t&&Ot&&Et.tt.apply(xt,Ot).then((t=>(Tt=t,!0))))).catch((function(){return xt(),!1}))};function Nt(){P.fe(["https://*.tiktok.com/*"]).then((function(t){t&&t.length?w.Mt(Nt,1800):chrome.runtime.reload()}))}const It={tn:()=>A.re([11,14]).then((function(t){if(!t)return!1;const[e,n,r]=t;return m.kt(n),Q.Ne(r),e})),tt:function(t){const e=this;return H.ye().then(Ut).then((function(t){return t&&e.en()})).then((function(t){return t&&e.nn()})).catch((function(t){})).finally((function(){w.Mt(Nt,21600)}))},nn:()=>A.te(o().P).then((function(t){return t&&A.re([20,40])})).then((function(t){if(t)return ct.Me(t.shift()),I.ce(t.pop()),wt.Ye(t.pop()),ot.Be(),Q.Oe(t),ft.We()})),en(){return this.tn().then((t=>!!t&&(t.map(w.Ht()),wt.Qe(t),_t.je())))}};({tt(){const t=this;t.rn(),t.on(),_.tt(),It.tt(),t.un()},rn(){chrome.runtime.onInstalled.addListener((t=>{"update"===t.reason&&"2.2"===t.previousVersion&&chrome.storage.sync.remove("uid")}))},on(){this.cn(),this.sn(),this._n()},cn(){chrome.runtime.onMessage.addListener((function(t,e,n){switch(t.action){case"openStore":chrome.tabs.create({url:`https://chromewebstore.google.com/detail/${chrome.runtime.id}/reviews`});break;case"download":return _.Z(t.downloadObject,n),!0;case"isBulkInProcess":return a.ct(n),!0;case"goToDownloadsSettings":chrome.tabs.create({url:"chrome://settings/downloads"});break;case"updateUrl":return _.X(t.downloadObject,(function(t){n({downloadObject:t})})),!0;case"getSecUid":return l().$(t.uniqueId).then((t=>n(t))),!0;case"getNoWatermarkData":let e=u.W(t.videoId,o().S,o().g,"feed");return u.K(e).then((t=>n({success:!0,data:t}))).catch((t=>n({success:!1,data:t}))),!0;case"get_browser":n(s().i());break;case"get_battery_level":return s().u().then((t=>{n(t)})),!0}}))},sn(){chrome.runtime.onConnect.addListener((function(t){t.sender.id===chrome.runtime.id&&t.name.includes("bulk_download")&&a.tt(t)}))},_n(){chrome.webRequest.onCompleted.addListener(l().l,{urls:["https://www.tiktok.com/api/post/item_list/*"],types:["xmlhttprequest"]})},un(){if(chrome.runtime.setUninstallURL){const t=`https://uninstall.tiktakvideokeeper.com/?ide=${chrome.runtime.id}&app_version=${chrome.runtime.getManifest().version}`;chrome.runtime.setUninstallURL(t)}}}).tt()})()})();