(()=>{function e(){$(".options_header a")[0].setAttribute("href","chrome-extension://"+chrome.runtime.id+"/options.html"),$(".rate_us_button a")[0].setAttribute("href","https://chrome.google.com/webstore/detail/"+chrome.runtime.id+"/reviews")}href="chrome-extension://pgdhemfjokcdecnbhjfinacpjdbeaknm/options.html";const t="custom_options_list",n="use_per_tab";class a{constructor(e,t,n,a,r,i){this.title=e,this.ua_string=t,this.vendor=n,this.badge=a,this.is_preset=r,this.append_to_default_ua=!1,this.group=i,this.is_managed=!1,this.key=""}}function r(){return chrome.storage.local}async function i(){const e=await chrome.storage.managed.get("OtherSettings").then((e=>e?.OtherSettings?.spoof_per_tab??null));return null!=e?e:(await chrome.storage.local.get(n))[n]}async function s(){return r().get(t).then((({[t]:e})=>e||[]))}async function o(){return((await chrome.storage.managed.get("UserAgents"))?.UserAgents||[]).map(((e,t)=>function({title:e,ua_string:t,vendor:n,badge:r,append:i},s){return Object.assign(new a,{is_managed:!0,title:e,ua_string:t,vendor:n,badge:r,append_to_default_ua:i,group:"Managed",key:void 0!==s?"cm_"+s:void 0})}(e,t)))}async function u(e){return e?(await i()||(e="no_spoof"),(await async function(){return(await chrome.storage.session.get("hotlist"))?.hotlist||{}}())[e]||null):null}function c(e){return e?.group||""}function l(){chrome.tabs.query({currentWindow:!0,active:!0}).then((async([e])=>{const t=await u(e.id);$("td").removeClass("popup_selected"),t&&($("td#ua_row_"+t).addClass("popup_selected"),function(e){return r().get(e).then((({[e]:t})=>t))}(t).then((function(e){$("td#ua_row_"+c(e)).addClass("popup_selected")})))}))}function d(e,t,n,a){let r=e;e.includes("Internet Explorer")&&(r="Internet Explorer"),e.includes("Default")&&(r="Chrome"),(e.includes("iPhone")||e.includes("iPad"))&&(r="iOS"),e.includes("Android")&&(r="Android"),e.includes("Windows")&&(r="Windows"),e.includes("Firefox")&&(r="Firefox"),e.includes("Opera")&&(r="Opera"),e.includes("Safari")&&(r="Safari");var i=document.createElement("tr"),s=document.createElement("td");(o=document.createElement("img")).setAttribute("src",`images/${r}.png`),o.className=`table_row_image ua_row_${a}`,s.appendChild(o),i.appendChild(s),i.setAttribute("class","table_row"),s=document.createElement("td");var o,u=document.createElement("a");return s.className=`popup_item ua_row_${a}`,u.appendChild(document.createTextNode(e)),s.appendChild(u),i.appendChild(s),s.setAttribute("id","ua_row_"+a),n&&(s=document.createElement("td"),(o=document.createElement("img")).setAttribute("src",n),o.setAttribute("class","ua_row_"+a),o.style.cursor="pointer",s.appendChild(o),"images/arrow.png"===n&&(o.setAttribute("class","return_default_view"),o.classList.remove("ua_row_"+a)),i.appendChild(s)),i}function p(e){const t=$("#sub_table_"+e);t.addClass("visible"),t.removeClass("invisible");const n=$("#group_table");n.addClass("invisible"),n.removeClass("visible")}function _(e){var t=$("#options_table");t.empty();var n=document.createElement("table");n.setAttribute("id","group_table"),t.append(n),(n=$("#group_table")).addClass("popup_group_table");var a=0;for(var r in e){n.append(d(""==r?"Default":r,0,"images/Chevron-right.png",a));var i=document.createElement("table");i.setAttribute("id","sub_table_"+a),t.append(i),$(".ua_row_"+a).on("click",function(e){return function(){p(e)}}(a)),(i=$("#sub_table_"+a)).addClass("popup_sub_table");const s=e[r];for(let e=0;e<s.length;e++){i.append(d(s[e].title,s[e].key,"images/arrow.png",""+s[e].key)),i.addClass("invisible");const t=s[e].key;$(".ua_row_"+s[e].key).on("click",(()=>{return e=t,void chrome.runtime.sendMessage({action:"setCurrent",target:"service_worker",ua_index:e},{},l);var e}))}a++}$(".return_default_view").click((e=>{e.preventDefault(),function(){let e=$(".visible")[0];e.removeAttribute("class","visible"),e.className="invisible popup_sub_table",$("#group_table").addClass("visible")}()})),1==a&&p(0),l()}chrome.declarativeNetRequest.MAX_NUMBER_OF_SESSION_RULES,$(window).on("load",(function(){(async function(){const e=await async function(){const[e,t]=await Promise.all([o(),s()]);if(!t||0===t.length)return e;const n=await r().get(t);return e.concat(Object.values(n))}();return Object.fromEntries(Map.groupBy(e,c))})().then(_).then(e)}))})();