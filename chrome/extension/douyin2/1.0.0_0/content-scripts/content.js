var xe=Object.defineProperty;var fe=(A,l,c)=>l in A?xe(A,l,{enumerable:!0,configurable:!0,writable:!0,value:c}):A[l]=c;var Z=(A,l,c)=>(fe(A,typeof l!="symbol"?l+"":l,c),c),J=(A,l,c)=>{if(!l.has(A))throw TypeError("Cannot "+c)};var B=(A,l,c)=>(J(A,l,"read from private field"),c?c.call(A):l.get(A)),L=(A,l,c)=>{if(l.has(A))throw TypeError("Cannot add the same private member more than once");l instanceof WeakSet?l.add(A):l.set(A,c)},re=(A,l,c,O)=>(J(A,l,"write to private field"),O?O.call(A,c):l.set(A,c),c);var K=(A,l,c)=>(J(A,l,"access private method"),c);(function(){"use strict";var R,k,j,P,q,W,se,V,te;function A(s){return s}var l=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function c(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var O={exports:{}};(function(s,t){(function(i,g){g(s)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:l,function(i){var g,v;if(!((v=(g=globalThis.chrome)==null?void 0:g.runtime)!=null&&v.id))throw new Error("This script should only be loaded in a browser extension.");if(typeof globalThis.browser>"u"||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const M="The message port closed before a response was received.",G=S=>{const m={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(m).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class d extends WeakMap{constructor(r,a=void 0){super(a),this.createItem=r}get(r){return this.has(r)||this.set(r,this.createItem(r)),super.get(r)}}const b=e=>e&&typeof e=="object"&&typeof e.then=="function",w=(e,r)=>(...a)=>{S.runtime.lastError?e.reject(new Error(S.runtime.lastError.message)):r.singleCallbackArg||a.length<=1&&r.singleCallbackArg!==!1?e.resolve(a[0]):e.resolve(a)},h=e=>e==1?"argument":"arguments",N=(e,r)=>function(o,...f){if(f.length<r.minArgs)throw new Error(`Expected at least ${r.minArgs} ${h(r.minArgs)} for ${e}(), got ${f.length}`);if(f.length>r.maxArgs)throw new Error(`Expected at most ${r.maxArgs} ${h(r.maxArgs)} for ${e}(), got ${f.length}`);return new Promise((p,E)=>{if(r.fallbackToNoCallback)try{o[e](...f,w({resolve:p,reject:E},r))}catch(n){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,n),o[e](...f),r.fallbackToNoCallback=!1,r.noCallback=!0,p()}else r.noCallback?(o[e](...f),p()):o[e](...f,w({resolve:p,reject:E},r))})},C=(e,r,a)=>new Proxy(r,{apply(o,f,p){return a.call(f,e,...p)}});let x=Function.call.bind(Object.prototype.hasOwnProperty);const I=(e,r={},a={})=>{let o=Object.create(null),f={has(E,n){return n in e||n in o},get(E,n,y){if(n in o)return o[n];if(!(n in e))return;let u=e[n];if(typeof u=="function")if(typeof r[n]=="function")u=C(e,e[n],r[n]);else if(x(a,n)){let _=N(n,a[n]);u=C(e,e[n],_)}else u=u.bind(e);else if(typeof u=="object"&&u!==null&&(x(r,n)||x(a,n)))u=I(u,r[n],a[n]);else if(x(a,"*"))u=I(u,r[n],a["*"]);else return Object.defineProperty(o,n,{configurable:!0,enumerable:!0,get(){return e[n]},set(_){e[n]=_}}),u;return o[n]=u,u},set(E,n,y,u){return n in o?o[n]=y:e[n]=y,!0},defineProperty(E,n,y){return Reflect.defineProperty(o,n,y)},deleteProperty(E,n){return Reflect.deleteProperty(o,n)}},p=Object.create(e);return new Proxy(p,f)},H=e=>({addListener(r,a,...o){r.addListener(e.get(a),...o)},hasListener(r,a){return r.hasListener(e.get(a))},removeListener(r,a){r.removeListener(e.get(a))}}),ce=new d(e=>typeof e!="function"?e:function(a){const o=I(a,{},{getContent:{minArgs:0,maxArgs:0}});e(o)}),Q=new d(e=>typeof e!="function"?e:function(a,o,f){let p=!1,E,n=new Promise(F=>{E=function(T){p=!0,F(T)}}),y;try{y=e(a,o,E)}catch(F){y=Promise.reject(F)}const u=y!==!0&&b(y);if(y!==!0&&!u&&!p)return!1;const _=F=>{F.then(T=>{f(T)},T=>{let Y;T&&(T instanceof Error||typeof T.message=="string")?Y=T.message:Y="An unexpected error occurred",f({__mozWebExtensionPolyfillReject__:!0,message:Y})}).catch(T=>{console.error("Failed to send onMessage rejected reply",T)})};return _(u?y:n),!0}),de=({reject:e,resolve:r},a)=>{S.runtime.lastError?S.runtime.lastError.message===M?r():e(new Error(S.runtime.lastError.message)):a&&a.__mozWebExtensionPolyfillReject__?e(new Error(a.message)):r(a)},ee=(e,r,a,...o)=>{if(o.length<r.minArgs)throw new Error(`Expected at least ${r.minArgs} ${h(r.minArgs)} for ${e}(), got ${o.length}`);if(o.length>r.maxArgs)throw new Error(`Expected at most ${r.maxArgs} ${h(r.maxArgs)} for ${e}(), got ${o.length}`);return new Promise((f,p)=>{const E=de.bind(null,{resolve:f,reject:p});o.push(E),a.sendMessage(...o)})},ue={devtools:{network:{onRequestFinished:H(ce)}},runtime:{onMessage:H(Q),onMessageExternal:H(Q),sendMessage:ee.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:ee.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},z={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return m.privacy={network:{"*":z},services:{"*":z},websites:{"*":z}},I(S,ue,m)};i.exports=G(chrome)}else i.exports=globalThis.browser})})(O);var ne=O.exports,$=c(ne);const ie={matches:["*://www.douyin.com/*"],main(){const s=$.runtime.getURL("/assets/base.svg"),t=m=>{var N;const d=m.target.parentElement,b=(N=d==null?void 0:d.parentElement)==null?void 0:N.getElementsByClassName("video-info-detail");let w;if(b&&(b==null?void 0:b.length)>0){const C=b[0].getElementsByClassName("account-name"),x=b[0].getElementsByClassName("title");C&&(C==null?void 0:C.length)>0&&(w=C[0].innerHTML.replace(/<[^>]*>/g,"")),x&&(x==null?void 0:x.length)>0&&(w=w+" "+x[0].innerHTML.replace(/<[^>]*>/g,""))}const h=d==null?void 0:d.querySelectorAll("video");if(h&&(h==null?void 0:h.length)>0){const x=h[0].querySelectorAll("source");if(x&&(x==null?void 0:x.length)>0){const I=x[x.length-1].src;$.runtime.sendMessage({type:"download",url:I,fileName:w+".mp4"})}}},i=()=>{const m=document.createElement("img");return m.addEventListener("click",t),m.className="download-button",m.style.position="absolute",m.style.top="30px",m.style.right="30px",m.style.zIndex="6999",m.src=s,m.style.width="35px",m.style.height="35px",m};function g(m,d){let b,w,h;return function(...N){b?(clearTimeout(w),w=window.setTimeout(()=>{Date.now()-h>=d&&(m.apply(this,N),h=Date.now())},Math.max(d-(Date.now()-h),0))):(m.apply(this,N),h=Date.now(),b=!0)}}const v=g(()=>{var d,b;const m=document.querySelectorAll("video");for(const w of m)w.parentElement&&((d=w.parentElement)==null?void 0:d.getElementsByClassName("download-button").length)==0&&((b=w.parentNode)==null||b.appendChild(i()))},600),M=new MutationObserver(m=>{for(const d of m)d.type==="childList"&&(d.addedNodes.length&&v(),d.removedNodes.length&&v())}),G={childList:!0,subtree:!0},S=document.body;setTimeout(()=>{M.observe(S,G)},1e3)}};var ae={VITE_CJS_IGNORE_WARNING:"true",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,MANIFEST_VERSION:3,BROWSER:"chrome",CHROME:!0,FIREFOX:!1,SAFARI:!1,EDGE:!1,OPERA:!1,COMMAND:"build",ENTRYPOINT:"content"};function D(s,...t){}var oe={debug:(...s)=>D(console.debug,...s),log:(...s)=>D(console.log,...s),warn:(...s)=>D(console.warn,...s),error:(...s)=>D(console.error,...s)},ge=(R=class extends Event{constructor(t,i){super(R.EVENT_NAME,{}),this.newUrl=t,this.oldUrl=i}},Z(R,"EVENT_NAME",X("wxt:locationchange")),R);function X(s){const t=typeof ae>"u"?"build":"content";return`${$.runtime.id}:${t}:${s}`}function le(s){let t,i;return{run(){t==null&&(i=new URL(location.href),t=s.setInterval(()=>{let g=new URL(location.href);g.href!==i.href&&(window.dispatchEvent(new ge(g,i)),i=g)},1e3))}}}var me=(k=class{constructor(t,i){L(this,W);L(this,V);L(this,j,window.self===window.top);L(this,P,void 0);L(this,q,le(this));this.contentScriptName=t,this.options=i,re(this,P,new AbortController),B(this,j)&&K(this,W,se).call(this),this.setTimeout(()=>{K(this,V,te).call(this)})}get signal(){return B(this,P).signal}abort(t){return B(this,P).abort(t)}get isInvalid(){return $.runtime.id==null&&this.notifyInvalidated(),this.signal.aborted}get isValid(){return!this.isInvalid}onInvalidated(t){return this.signal.addEventListener("abort",t),()=>this.signal.removeEventListener("abort",t)}block(){return new Promise(()=>{})}setInterval(t,i){const g=setInterval(()=>{this.isValid&&t()},i);return this.onInvalidated(()=>clearInterval(g)),g}setTimeout(t,i){const g=setTimeout(()=>{this.isValid&&t()},i);return this.onInvalidated(()=>clearTimeout(g)),g}requestAnimationFrame(t){const i=requestAnimationFrame((...g)=>{this.isValid&&t(...g)});return this.onInvalidated(()=>cancelAnimationFrame(i)),i}requestIdleCallback(t,i){const g=requestIdleCallback((...v)=>{this.signal.aborted||t(...v)},i);return this.onInvalidated(()=>cancelIdleCallback(g)),g}addEventListener(t,i,g,v){var M;i==="wxt:locationchange"&&this.isValid&&B(this,q).run(),(M=t.addEventListener)==null||M.call(t,i.startsWith("wxt:")?X(i):i,g,{...v,signal:this.signal})}notifyInvalidated(){this.abort("Content script context invalidated"),oe.debug(`Content script "${this.contentScriptName}" context invalidated`)}},j=new WeakMap,P=new WeakMap,q=new WeakMap,W=new WeakSet,se=function(){window.postMessage({event:k.SCRIPT_STARTED_MESSAGE_TYPE,contentScriptName:this.contentScriptName},"*")},V=new WeakSet,te=function(){const t=i=>{var g,v;((g=i.data)==null?void 0:g.type)===k.SCRIPT_STARTED_MESSAGE_TYPE&&((v=i.data)==null?void 0:v.contentScriptName)===this.contentScriptName&&this.notifyInvalidated()};addEventListener("message",t),this.onInvalidated(()=>removeEventListener("message",t))},Z(k,"SCRIPT_STARTED_MESSAGE_TYPE","wxt:content-script-started"),k);function U(s,...t){}var Ae={debug:(...s)=>U(console.debug,...s),log:(...s)=>U(console.log,...s),warn:(...s)=>U(console.warn,...s),error:(...s)=>U(console.error,...s)};(async()=>{try{const{main:s,...t}=ie,i=new me("content",t);await s(i)}catch(s){Ae.error('The content script "content" crashed on startup!',s)}})()})();
